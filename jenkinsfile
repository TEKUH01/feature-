pipeline {
    agent any
    
    stages {
        stage('Generate Sample Data') {
            steps {
                script {
                    // Generate sample student data
                    writeFile file: 'students.csv', text: """
                        1,John Doe,A
                        2,Jane Smith,B
                        3,Michael Johnson,C
                        4,Emily Brown,A
                        5,David Lee,B
                    """
                    
                    // Display the generated sample data
                    echo "Generated sample student data:"
                    sh 'cat students.csv'
                }
            }
        }
        
        stage('Register Students') {
            steps {
                script {
                    // Loop through each line in the CSV file and simulate registering the students
                    def studentsData = readFile 'students.csv'
                    studentsData.eachLine { line ->
                        def (id, name, grade) = line.split(',')
                        
                        // Simulate registering the student
                        echo "Registering student: $name (ID: $id, Grade: $grade)"
                        sleep 1  // Simulate some processing time
                        
                        // Output registration status
                        echo "Registered student: $name (ID: $id, Grade: $grade)"
                    }
                }
            }
        }
    }
    
    post {
        success {
            echo 'Student registration process completed successfully!'
        }
        failure {
            echo 'Student registration process failed. Please check the logs for details.'
        }
    }
}

